<script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@2.5.0/dist/pptxgen.bundle.js"></script>
<script>
let pptx = new PptxGenJS();
pptx.setLayout('LAYOUT_WIDE');

fetch('https://www.mocaspike150.org/data/stories.json')
  .then(res => res.json())
  .then((data) => {
    for(const id in data) {
      console.log(data[id]);
      let slide = pptx.addNewSlide();
      let path = 'https://www.mocaspike150.org/assets/images/moca-spike-150-share.jpg'
      slide.back = 'FFFFFF';
      slide.addImage({ path: path, x:1, y:1, w:6, h:4 })
      slide.addText(
        [ { text: data[id]['title']  }], { x: 1.5, y:1.5, w:8, h:2, margin:0.1, fontSize: 48}
      );

      slide.addText(
        [ { text: data[id]['story-en'] }], { x: 5, y: 1.5, w:8, h:4, margin:0.1, fontSize: 12}
      );

      let slide_cn = pptx.addNewSlide();
      slide_cn.back = 'FFFFFF';
      slide_cn.addImage({ path: path, x:1, y:1, w:6, h:4 })
      slide_cn.addText(
        [ { text: data[id]['title-cn'] ? data[id]['title-cn'] : ''  }], { x: 1.5, y:1.5, w:8, h:2, margin:0.1, fontSize: 48 }
      );

      slide_cn.addText(
        [ { text: data[id]['story-cn'] }], { x: 5, y: 1.5, w:8, h:4, margin:0.1, fontSize: 12}
      );
    }
    pptx.save(`spike150-slideshow-${Date.now()}`);
  })
.catch(err => { throw err });

</script>

